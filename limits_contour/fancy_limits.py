#fancy limit plotter, unfortunately doesn't woth with CMMSSW environment (yet). Requires scipy >=1.4

from scipy import interpolate
import numpy as np
import matplotlib.pyplot as plt
import matplotlib.mlab as mlab
import matplotlib.colors as mcol





exp = np.array([
        [1000.0, 3.0, 0.0288],
[1050.0, 3.0, 0.0376],
[1100.0, 3.0, 0.0503],
[1150.0, 3.0, 0.063],
[1200.0, 3.0, 0.0864],
[1250.0, 3.0, 0.1089],
[1300.0, 3.0, 0.1411],
[1350.0, 3.0, 0.1841],
[1400.0, 3.0, 0.2295],
[1450.0, 3.0, 0.2939],
[1500.0, 3.0, 0.3682],
[1550.0, 3.0, 0.4902],
[1600.0, 3.0, 0.6074],
[1650.0, 3.0, 0.793],
[1700.0, 3.0, 1.0352],
[1750.0, 3.0, 1.293],
[1800.0, 3.0, 1.7266],
[1850.0, 3.0, 2.0703],
[1900.0, 3.0, 2.5859],
[1950.0, 3.0, 3.4531],
[2000.0, 3.0, 5.1719],
[1000.0, 53.0, 0.0171],
[1050.0, 53.0, 0.022],
[1100.0, 53.0, 0.0288],
[1150.0, 53.0, 0.0376],
[1200.0, 53.0, 0.0493],
[1250.0, 53.0, 0.064],
[1300.0, 53.0, 0.0845],
[1350.0, 53.0, 0.1079],
[1400.0, 53.0, 0.1411],
[1450.0, 53.0, 0.1782],
[1500.0, 53.0, 0.2295],
[1550.0, 53.0, 0.2939],
[1600.0, 53.0, 0.3682],
[1650.0, 53.0, 0.4902],
[1700.0, 53.0, 0.6074],
[1750.0, 53.0, 0.793],
[1800.0, 53.0, 1.0352],
[1850.0, 53.0, 1.293],
[1900.0, 53.0, 1.7266],
[1950.0, 53.0, 2.0703],
[2000.0, 53.0, 2.5859],
[1000.0, 103.0, 0.0161],
[1050.0, 103.0, 0.021],
[1100.0, 103.0, 0.0269],
[1150.0, 103.0, 0.0356],
[1200.0, 103.0, 0.0464],
[1250.0, 103.0, 0.061],
[1300.0, 103.0, 0.0776],
[1350.0, 103.0, 0.0991],
[1400.0, 103.0, 0.1304],
[1450.0, 103.0, 0.1636],
[1500.0, 103.0, 0.2158],
[1550.0, 103.0, 0.2715],
[1600.0, 103.0, 0.3564],
[1650.0, 103.0, 0.4316],
[1700.0, 103.0, 0.543],
[1750.0, 103.0, 0.6895],
[1800.0, 103.0, 0.9414],
[1850.0, 103.0, 1.1445],
[1900.0, 103.0, 1.4727],
[1950.0, 103.0, 2.0703],
[2000.0, 103.0, 2.5859],
[1000.0, 153.0, 0.0171],
[1050.0, 153.0, 0.022],
[1100.0, 153.0, 0.0288],
[1150.0, 153.0, 0.0366],
[1200.0, 153.0, 0.0483],
[1250.0, 153.0, 0.063],
[1300.0, 153.0, 0.0825],
[1350.0, 153.0, 0.104],
[1400.0, 153.0, 0.1343],
[1450.0, 153.0, 0.1694],
[1500.0, 153.0, 0.2197],
[1550.0, 153.0, 0.2783],
[1600.0, 153.0, 0.3564],
[1650.0, 153.0, 0.4473],
[1700.0, 153.0, 0.5723],
[1750.0, 153.0, 0.7363],
[1800.0, 153.0, 0.9414],
[1850.0, 153.0, 1.1445],
[1900.0, 153.0, 1.4727],
[1950.0, 153.0, 2.0703],
[2000.0, 153.0, 2.5859],
[1000.0, 203.0, 0.019],
[1050.0, 203.0, 0.0239],
[1100.0, 203.0, 0.0317],
[1150.0, 203.0, 0.0405],
[1200.0, 203.0, 0.0513],
[1250.0, 203.0, 0.0679],
[1300.0, 203.0, 0.0894],
[1350.0, 203.0, 0.1138],
[1400.0, 203.0, 0.145],
[1450.0, 203.0, 0.1841],
[1500.0, 203.0, 0.2295],
[1550.0, 203.0, 0.3037],
[1600.0, 203.0, 0.3818],
[1650.0, 203.0, 0.4707],
[1700.0, 203.0, 0.6074],
[1750.0, 203.0, 0.793],
[1800.0, 203.0, 1.0352],
[1850.0, 203.0, 1.293],
[1900.0, 203.0, 1.7266],
[1950.0, 203.0, 2.0703],
[2000.0, 203.0, 2.5859],
[1000.0, 253.0, 0.021],
[1050.0, 253.0, 0.0269],
[1100.0, 253.0, 0.0356],
[1150.0, 253.0, 0.0454],
[1200.0, 253.0, 0.0591],
[1250.0, 253.0, 0.0757],
[1300.0, 253.0, 0.0952],
[1350.0, 253.0, 0.1245],
[1400.0, 253.0, 0.1587],
[1450.0, 253.0, 0.2021],
[1500.0, 253.0, 0.2588],
[1550.0, 253.0, 0.3232],
[1600.0, 253.0, 0.4121],
[1650.0, 253.0, 0.5176],
[1700.0, 253.0, 0.6465],
[1750.0, 253.0, 0.8633],
[1800.0, 253.0, 1.0352],
[1850.0, 253.0, 1.4727],
[1900.0, 253.0, 1.7266],
[1950.0, 253.0, 2.0703],
[2000.0, 253.0, 2.5859],
[1000.0, 303.0, 0.0239],
[1050.0, 303.0, 0.0298],
[1100.0, 303.0, 0.0396],
[1150.0, 303.0, 0.0493],
[1200.0, 303.0, 0.063],
[1250.0, 303.0, 0.0796],
[1300.0, 303.0, 0.103],
[1350.0, 303.0, 0.1343],
[1400.0, 303.0, 0.1753],
[1450.0, 303.0, 0.2197],
[1500.0, 303.0, 0.2783],
[1550.0, 303.0, 0.3564],
[1600.0, 303.0, 0.4473],
[1650.0, 303.0, 0.5723],
[1700.0, 303.0, 0.7363],
[1750.0, 303.0, 0.9414],
[1800.0, 303.0, 1.1445],
[1850.0, 303.0, 1.4727],
[1900.0, 303.0, 1.7266],
[1950.0, 303.0, 2.5859],
[2000.0, 303.0, 3.4531],
[1000.0, 353.0, 0.0259],
[1050.0, 353.0, 0.0337],
[1100.0, 353.0, 0.0444],
[1150.0, 353.0, 0.0562],
[1200.0, 353.0, 0.0698],
[1250.0, 353.0, 0.0884],
[1300.0, 353.0, 0.1157],
[1350.0, 353.0, 0.145],
[1400.0, 353.0, 0.1841],
[1450.0, 353.0, 0.2354],
[1500.0, 353.0, 0.3037],
[1550.0, 353.0, 0.3818],
[1600.0, 353.0, 0.4902],
[1650.0, 353.0, 0.6074],
[1700.0, 353.0, 0.793],
[1750.0, 353.0, 0.9414],
[1800.0, 353.0, 1.293],
[1850.0, 353.0, 1.4727],
[1900.0, 353.0, 2.0703],
[1950.0, 353.0, 2.5859],
[2000.0, 353.0, 3.4531],
[1000.0, 403.0, 0.0298],
[1050.0, 403.0, 0.0386],
[1100.0, 403.0, 0.0493],
[1150.0, 403.0, 0.0601],
[1200.0, 403.0, 0.0767],
[1250.0, 403.0, 0.1001],
[1300.0, 403.0, 0.1245],
[1350.0, 403.0, 0.1587],
[1400.0, 403.0, 0.1982],
[1450.0, 403.0, 0.251],
[1500.0, 403.0, 0.333],
[1550.0, 403.0, 0.4316],
[1600.0, 403.0, 0.5176],
[1650.0, 403.0, 0.6465],
[1700.0, 403.0, 0.793],
[1750.0, 403.0, 1.0352],
[1800.0, 403.0, 1.293],
[1850.0, 403.0, 1.7266],
[1900.0, 403.0, 2.0703],
[1950.0, 403.0, 2.5859],
[2000.0, 403.0, 3.4531],
[1000.0, 453.0, 0.0337],
[1050.0, 453.0, 0.0415],
[1100.0, 453.0, 0.0532],
[1150.0, 453.0, 0.0659],
[1200.0, 453.0, 0.0815],
[1250.0, 453.0, 0.1089],
[1300.0, 453.0, 0.1357],
[1350.0, 453.0, 0.1694],
[1400.0, 453.0, 0.2197],
[1450.0, 453.0, 0.2715],
[1500.0, 453.0, 0.3447],
[1550.0, 453.0, 0.4473],
[1600.0, 453.0, 0.543],
[1650.0, 453.0, 0.6895],
[1700.0, 453.0, 0.8633],
[1750.0, 453.0, 1.1445],
[1800.0, 453.0, 1.4727],
[1850.0, 453.0, 1.7266],
[1900.0, 453.0, 2.5859],
[1950.0, 453.0, 3.4531],
[2000.0, 453.0, 3.4531],
[1000.0, 503.0, 0.0366],
[1050.0, 503.0, 0.0474],
[1100.0, 503.0, 0.0571],
[1150.0, 503.0, 0.0718],
[1200.0, 503.0, 0.0923],
[1250.0, 503.0, 0.1187],
[1300.0, 503.0, 0.147],
[1350.0, 503.0, 0.1841],
[1400.0, 503.0, 0.2354],
[1450.0, 503.0, 0.2939],
[1500.0, 503.0, 0.3818],
[1550.0, 503.0, 0.4707],
[1600.0, 503.0, 0.5723],
[1650.0, 503.0, 0.793],
[1700.0, 503.0, 0.9414],
[1750.0, 503.0, 1.1445],
[1800.0, 503.0, 1.4727],
[1850.0, 503.0, 2.0703],
[1900.0, 503.0, 2.5859],
[1950.0, 503.0, 3.4531],
[2000.0, 503.0, 5.1719],
[1000.0, 553.0, 0.0425],
[1050.0, 553.0, 0.0542],
[1100.0, 553.0, 0.0649],
[1150.0, 553.0, 0.0815],
[1200.0, 553.0, 0.0991],
[1250.0, 553.0, 0.1255],
[1300.0, 553.0, 0.1567],
[1350.0, 553.0, 0.1982],
[1400.0, 553.0, 0.251],
[1450.0, 553.0, 0.3232],
[1500.0, 553.0, 0.3965],
[1550.0, 553.0, 0.5176],
[1600.0, 553.0, 0.6465],
[1650.0, 553.0, 0.793],
[1700.0, 553.0, 1.0352],
[1750.0, 553.0, 1.293],
[1800.0, 553.0, 1.7266],
[1850.0, 553.0, 2.0703],
[1900.0, 553.0, 2.5859],
[1950.0, 553.0, 3.4531],
[2000.0, 553.0, 5.1719],
[1000.0, 603.0, 0.0503],
[1050.0, 603.0, 0.061],
[1100.0, 603.0, 0.0728],
[1150.0, 603.0, 0.0894],
[1200.0, 603.0, 0.1089],
[1250.0, 603.0, 0.1357],
[1300.0, 603.0, 0.1753],
[1350.0, 603.0, 0.2197],
[1400.0, 603.0, 0.2715],
[1450.0, 603.0, 0.3447],
[1500.0, 603.0, 0.4316],
[1550.0, 603.0, 0.543],
[1600.0, 603.0, 0.6895],
[1650.0, 603.0, 0.8633],
[1700.0, 603.0, 1.0352],
[1750.0, 603.0, 1.4727],
[1800.0, 603.0, 1.7266],
[1850.0, 603.0, 2.0703],
[1900.0, 603.0, 2.5859],
[1950.0, 603.0, 3.4531],
[2000.0, 603.0, 5.1719],
[1000.0, 653.0, 0.0601],
[1050.0, 653.0, 0.0698],
[1100.0, 653.0, 0.0835],
[1150.0, 653.0, 0.0972],
[1200.0, 653.0, 0.1187],
[1250.0, 653.0, 0.1499],
[1300.0, 653.0, 0.1812],
[1350.0, 653.0, 0.2354],
[1400.0, 653.0, 0.2861],
[1450.0, 653.0, 0.3682],
[1500.0, 653.0, 0.4473],
[1550.0, 653.0, 0.6074],
[1600.0, 653.0, 0.7363],
[1650.0, 653.0, 0.9414],
[1700.0, 653.0, 1.1445],
[1750.0, 653.0, 1.4727],
[1800.0, 653.0, 1.7266],
[1850.0, 653.0, 2.5859],
[1900.0, 653.0, 3.4531],
[1950.0, 653.0, 3.4531],
[2000.0, 653.0, 5.1719],
[1000.0, 703.0, 0.0825],
[1050.0, 703.0, 0.0835],
[1100.0, 703.0, 0.0962],
[1150.0, 703.0, 0.1147],
[1200.0, 703.0, 0.1357],
[1250.0, 703.0, 0.1616],
[1300.0, 703.0, 0.2021],
[1350.0, 703.0, 0.251],
[1400.0, 703.0, 0.3232],
[1450.0, 703.0, 0.3818],
[1500.0, 703.0, 0.4902],
[1550.0, 703.0, 0.6074],
[1600.0, 703.0, 0.793],
[1650.0, 703.0, 0.9414],
[1700.0, 703.0, 1.293],
[1750.0, 703.0, 1.4727],
[1800.0, 703.0, 2.0703],
[1850.0, 703.0, 2.5859],
[1900.0, 703.0, 3.4531],
[1950.0, 703.0, 5.1719],
[2000.0, 703.0, 5.1719],
[1000.0, 753.0, 0.1294],
[1050.0, 753.0, 0.1108],
[1100.0, 753.0, 0.1147],
[1150.0, 753.0, 0.1274],
[1200.0, 753.0, 0.1538],
[1250.0, 753.0, 0.1782],
[1300.0, 753.0, 0.2197],
[1350.0, 753.0, 0.2715],
[1400.0, 753.0, 0.333],
[1450.0, 753.0, 0.4121],
[1500.0, 753.0, 0.543],
[1550.0, 753.0, 0.6465],
[1600.0, 753.0, 0.8633],
[1650.0, 753.0, 1.0352],
[1700.0, 753.0, 1.293],
[1750.0, 753.0, 1.7266],
[1800.0, 753.0, 2.0703],
[1850.0, 753.0, 2.5859],
[1900.0, 753.0, 3.4531],
[1950.0, 753.0, 5.1719],
[2000.0, 753.0, 5.1719],
[1000.0, 803.0, 0.2354],
[1050.0, 803.0, 0.1782],
[1100.0, 803.0, 0.1519],
[1150.0, 803.0, 0.1587],
[1200.0, 803.0, 0.1724],
[1250.0, 803.0, 0.2021],
[1300.0, 803.0, 0.2451],
[1350.0, 803.0, 0.2861],
[1400.0, 803.0, 0.3682],
[1450.0, 803.0, 0.4316],
[1500.0, 803.0, 0.5723],
[1550.0, 803.0, 0.6895],
[1600.0, 803.0, 0.8633],
[1650.0, 803.0, 1.0352],
[1700.0, 803.0, 1.293],
[1750.0, 803.0, 1.7266],
[1800.0, 803.0, 2.0703],
[1850.0, 803.0, 2.5859],
[1900.0, 803.0, 3.4531],
[1950.0, 803.0, 5.1719],
[2000.0, 803.0, 5.1719],
[1000.0, 853.0, 0.4121],
[1050.0, 853.0, 0.3232],
[1100.0, 853.0, 0.2451],
[1150.0, 853.0, 0.2021],
[1200.0, 853.0, 0.2158],
[1250.0, 853.0, 0.2354],
[1300.0, 853.0, 0.2715],
[1350.0, 853.0, 0.333],
[1400.0, 853.0, 0.3965],
[1450.0, 853.0, 0.4902],
[1500.0, 853.0, 0.5723],
[1550.0, 853.0, 0.7363],
[1600.0, 853.0, 0.9414],
[1650.0, 853.0, 1.1445],
[1700.0, 853.0, 1.4727],
[1750.0, 853.0, 1.7266],
[1800.0, 853.0, 2.5859],
[1850.0, 853.0, 3.4531],
[1900.0, 853.0, 3.4531],
[1950.0, 853.0, 5.1719],
[2000.0, 853.0, 5.1719]
    ]
)




def interp(data, method='linear'):
    x = data[:,0]
    y = data[:,1]
    z = data[:,2]
    
    xi = np.linspace(x.min(), x.max(), 1000)
    yi = np.linspace(y.min(), y.max(), 1000)
    zi = mlab.griddata(x, y, z, xi, yi, interp=method)
    
    return xi, yi, zi



def interp2(data, method='linear'):
    x = data[:,0]
    y = data[:,1]
    z = data[:,2]
    
    xi = np.linspace(x.min(), x.max(), 1000)
    yi = np.linspace(y.min(), y.max(), 1000)
    xi, yi = np.meshgrid(xi,yi)
    zi = interpolate.griddata((x, y), z, (xi, yi), method=method)
    
    return xi, yi, zi



def interp3(data, method='linear'):
    x = data[:,0]
    y = data[:,1]
    z = data[:,2]
    
    xi = np.linspace(x.min(), x.max(), 1000)
    yi = np.linspace(y.min(), y.max(), 1000)
    xi, yi = np.meshgrid(xi,yi)
    zi = interpolate.LinearNDInterpolator(x, y, z, method=method)(xi, yi)
    
    return xi, yi, zi



stops = [0.0000, 0.1250, 0.2500, 0.3750, 0.5000, 0.6250, 0.7500, 0.8750, 1.0000]
red   = [0.2082, 0.0592, 0.0780, 0.0232, 0.1802, 0.5301, 0.8186, 0.9956, 0.9764]
green = [0.1664, 0.3599, 0.5041, 0.6419, 0.7178, 0.7492, 0.7328, 0.7862, 0.9832]
blue  = [0.5293, 0.8684, 0.8385, 0.7914, 0.6425, 0.4662, 0.3499, 0.1968, 0.0539]

ered = []
egreen = []
eblue = []
for i, stop in enumerate(stops):
    if i is 0:
        ered.append( (stop, 0., red[i]) )
        egreen.append( (stop, 0., green[i]) )
        eblue.append( (stop, 0., blue[i]) )
    elif i is len(stops)-1:
        ered.append( (stop, red[i], 1.) )
        egreen.append( (stop, green[i], 1.) )
        eblue.append( (stop, blue[i], 1.) )
    else:
        ered.append( (stop, red[i], red[i]) )
        egreen.append( (stop, green[i], green[i]) )
        eblue.append( (stop, blue[i], blue[i]) )
cdict = {'red': ered, 'green': egreen, 'blue': eblue}

bird = mcol.LinearSegmentedColormap('bird', cdict)




xi, yi, zi = interp2(exp, 'cubic')
plt.contour(xi, yi, zi, [1.0], colors='k')
plt.contourf(xi, yi, zi, 200, cmap=bird)
plt.colorbar()


plt.title('Ms=20 GeV, cubic interpolation')
plt.show()

xi, yi, zi = interp2(exp, 'linear')
plt.contour(xi, yi, zi, [1.0], colors='k')
plt.contourf(xi, yi, zi, 200, cmap=bird)
plt.colorbar()

plt.title('Ms=20, linear interpolation')
plt.show()
